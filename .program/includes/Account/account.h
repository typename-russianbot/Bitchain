#pragma once
#include "../Bitchain/bitchain.h"

//& @class: Account
class Account
{
private:
    //* Trackers
    string username; //* @var: username
    string passkey;  //* @var: passkey
    int keys;        //* @var: keys

    //* Components
    Bitchain bitchain; //* @var: bitchain
    //* fstream savefile
    //* fstream cachefile

protected:
    //? @defgroup: Functions
    //////////////////////////////////////////////////////////////////////////////////////////////
    //^ @protected: lookup(const string)
    //^ @def: searches for target username in accounts.txt & stores Account data if there's
    //^       a hit

    bool lookup(const string);
    //////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////
    //^ @protected: probe(void)
    //^ @def: stores currently saved data in cache

    bool probe(void);
    //////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////
    //^ @protected: keysearch(const string)
    //^ @def: true = hit, false = miss

    bool keysearch(const string);
    //////////////////////////////////////////////////////////////////////////////////////////////

public:
    //? @defgroup: Resources
    //////////////////////////////////////////////////////////////////////////////////////////////
    //* @public: Account

    Account(const string = "username", const string = "passkey"); //* @def: default constructor
    Account(const Account &);                                     //* @def: copy constructor
    //////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////
    //* @public: ~Account(void)
    //* @def: destructor

    ~Account(void);
    //////////////////////////////////////////////////////////////////////////////////////////////

    //? @defgroup: Key Modification
    //////////////////////////////////////////////////////////////////////////////////////////////
    //* @public: add

    void add(void);        //* @def: adds user inputted key
    void add(const Key &); //* @def: adds a designated key
    //////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////
    //* @public: remove

    bool remove(void);         //* @def: removes user inputted keyname
    bool remove(const string); //* @def: removes a designated key
    //////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////
    //* @public: search

    void search(void);         //* @def: searches for user inputted keyname
    void search(const string); //* @def: searches for a designated key
    //////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////
    //* @public: print

    void print(void);         //* @def: prints all keys
    void print(const string); //* @def: prints a designated key
    //////////////////////////////////////////////////////////////////////////////////////////////

    //? @defgroup: Account Functions
    //////////////////////////////////////////////////////////////////////////////////////////////
    //* @public: save
    //* @def: writes account data to savefile

    bool save(void);
    //////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////
    //* @public: load

    bool load(void);         //* @def: loads account from input username
    bool load(const string); //* @def: loads designated account
    //////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////
    //* @public: wipe

    bool wipe(void);         //* @def: wipes account from input username
    bool wipe(const string); //* @fn: wipe(const string)
    //////////////////////////////////////////////////////////////////////////////////////////////

    //? @defgroup: Cache Functions
    //////////////////////////////////////////////////////////////////////////////////////////////
    //* @public: saveToCache(void)
    //* @def: writes account data to cachefile

    bool saveToCache(void);
    //////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////
    //* @public loadFromCache(void)
    //* @def: loads account data from cachefile

    bool loadFromCache(void);
    //////////////////////////////////////////////////////////////////////////////////////////////

    //? @defgroup: Mutators
    //////////////////////////////////////////////////////////////////////////////////////////////
    //* @public: setUsername(const string)
    //* @def: sets username

    void setUsername(const string);
    //////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////
    //* @public: setPasskey(const string)
    //* @def: sets passkey

    void setPasskey(const string);
    //////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////
    //* @public: setKeys(const int)
    //* @def: sets # of keys

    void setKeys(const int);
    //////////////////////////////////////////////////////////////////////////////////////////////

    //? @defgroup: Accessors
    //////////////////////////////////////////////////////////////////////////////////////////////
    //* @public: getUsername(void)
    //* @def: returns username

    const string getUsername(void);
    //////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////
    //* @public: getPasskey(void)
    //* @def: returns passkey

    const string getPasskey(void);
    //////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////
    //* @public: getKeys(void)
    //* @def: returns # of keys

    int getKeys(void);
    //////////////////////////////////////////////////////////////////////////////////////////////

    //? @defgroup: Overloads
    //////////////////////////////////////////////////////////////////////////////////////////////
    //* @public: operator<<(ostream&, const Account&)
    //* @def: prints username, password, & # of keys

    friend ostream &operator<<(ostream &, const Account &);
    //////////////////////////////////////////////////////////////////////////////////////////////
    //////////////////////////////////////////////////////////////////////////////////////////////
    //* @public: operator=(const Account&)
    //* @def:

    Account &operator=(const Account &);
    //////////////////////////////////////////////////////////////////////////////////////////////
};